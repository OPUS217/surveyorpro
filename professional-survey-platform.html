<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SurveyPro Elite - Professional Land Surveying Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #7c3aed;
            --primary-dark: #6d28d9;
            --secondary: #10b981;
            --accent: #f59e0b;
            --danger: #ef4444;
            --bg-dark: #1f2937;
            --bg-light: #f9fafb;
            --text-dark: #111827;
            --text-light: #6b7280;
            --border: #e5e7eb;
            --success: #10b981;
            --warning: #f59e0b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: var(--bg-light);
            border-bottom: 2px solid var(--border);
            overflow-x: auto;
        }

        .tab {
            padding: 18px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
            white-space: nowrap;
            position: relative;
        }

        .tab:hover {
            color: var(--primary);
            background: rgba(124, 58, 237, 0.05);
        }

        .tab.active {
            color: var(--primary);
            background: white;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--primary);
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .card h3 {
            color: var(--text-dark);
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-dark);
            font-weight: 600;
            font-size: 0.95em;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .btn-secondary {
            background: var(--text-light);
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-block {
            width: 100%;
        }

        .result-box {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .result-box h4 {
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .result-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .result-item label {
            display: block;
            font-size: 0.85em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .result-item .value {
            font-size: 1.4em;
            font-weight: 700;
        }

        #plotCanvas {
            border: 2px solid var(--border);
            border-radius: 12px;
            max-width: 100%;
            background: white;
            cursor: crosshair;
        }

        .coordinate-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }

        .coordinate-item {
            background: var(--bg-light);
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Courier New', monospace;
        }

        .coordinate-item:hover {
            background: #e5e7eb;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .badge-primary {
            background: rgba(124, 58, 237, 0.1);
            color: var(--primary);
        }

        .equipment-card {
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .equipment-card:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .equipment-card h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .price {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--success);
            margin: 10px 0;
        }

        .info-box {
            background: rgba(124, 58, 237, 0.05);
            border-left: 4px solid var(--primary);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.05);
            border-left: 4px solid var(--warning);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .learning-card {
            display: flex;
            gap: 20px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .learning-card:hover {
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .learning-card img {
            width: 120px;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
        }

        .learning-content {
            flex: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-card .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .verification-code {
            background: rgba(16, 185, 129, 0.1);
            border: 2px dashed var(--success);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
        }

        .verification-code .code {
            font-size: 2em;
            font-weight: 700;
            color: var(--success);
            font-family: 'Courier New', monospace;
            letter-spacing: 3px;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from { transform: translateX(400px); }
            to { transform: translateX(0); }
        }

        .toast.show {
            display: block;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .tabs {
                flex-wrap: nowrap;
                overflow-x: scroll;
            }

            .tab {
                padding: 15px 20px;
                font-size: 0.9em;
            }

            .content {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .plot-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        table th,
        table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        table th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-dark);
        }

        table tr:hover {
            background: var(--bg-light);
        }

        .payment-split {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .payment-split-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            margin-bottom: 10px;
            backdrop-filter: blur(10px);
        }

        .payment-split-item .percentage {
            font-size: 1.5em;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç SurveyPro Elite</h1>
            <p>Professional Land Surveying & Geospatial Platform</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('survey')">üìä New Survey</button>
            <button class="tab" onclick="switchTab('plot')">üìê Plot & Calculate</button>
            <button class="tab" onclick="switchTab('equipment')">üéØ Rent Equipment</button>
            <button class="tab" onclick="switchTab('learning')">üìö Learning Hub</button>
            <button class="tab" onclick="switchTab('results')">‚úÖ Survey Results</button>
        </div>

        <div class="content">
            <!-- Survey Tab -->
            <div id="survey" class="tab-content active">
                <div class="card">
                    <h3>üÜï Create New Survey</h3>
                    <div class="info-box">
                        <strong>Professional Survey Standards:</strong> All surveys follow WGS 84 / UTM coordinate system standards. Verification codes are generated for each completed survey.
                    </div>

                    <div class="form-group">
                        <label>Survey Type</label>
                        <select id="surveyType">
                            <option value="boundary">Boundary Survey</option>
                            <option value="topographic">Topographic Survey</option>
                            <option value="construction">Construction Survey</option>
                            <option value="cadastral">Cadastral Survey</option>
                            <option value="hydrographic">Hydrographic Survey</option>
                            <option value="engineering">Engineering Survey</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Client Name</label>
                            <input type="text" id="clientName" placeholder="Enter client name">
                        </div>
                        <div class="form-group">
                            <label>Project Name</label>
                            <input type="text" id="projectName" placeholder="Enter project name">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Coordinate System</label>
                            <select id="coordSystem">
                                <option value="WGS84-UTM31N">WGS 84 / UTM Zone 31N</option>
                                <option value="WGS84-UTM32N">WGS 84 / UTM Zone 32N</option>
                                <option value="WGS84-UTM33N">WGS 84 / UTM Zone 33N</option>
                                <option value="NAD83">NAD 83</option>
                                <option value="OSGB36">OSGB 36 (British National Grid)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Survey Date</label>
                            <input type="date" id="surveyDate">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Location/Description</label>
                        <textarea id="location" rows="3" placeholder="Enter survey location and description"></textarea>
                    </div>

                    <button class="btn btn-primary btn-block" onclick="startSurvey()">
                        üöÄ Start Survey
                    </button>
                </div>

                <div id="activeSurvey" style="display: none;">
                    <div class="card">
                        <h3>üìç Active Survey</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="pointCount">0</div>
                                <div class="stat-label">Points Recorded</div>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                <div class="stat-value" id="areaHectares">0.0000</div>
                                <div class="stat-label">Hectares</div>
                            </div>
                            <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                <div class="stat-value" id="areaAcres">0.0000</div>
                                <div class="stat-label">Acres</div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Northing (m)</label>
                                <input type="number" id="northing" step="0.001" placeholder="Enter northing coordinate">
                            </div>
                            <div class="form-group">
                                <label>Easting (m)</label>
                                <input type="number" id="easting" step="0.001" placeholder="Enter easting coordinate">
                            </div>
                            <div class="form-group">
                                <label>Elevation (m)</label>
                                <input type="number" id="elevation" step="0.001" placeholder="Enter elevation">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Point Description</label>
                            <input type="text" id="pointDesc" placeholder="E.g., Corner stake, Property pin, etc.">
                        </div>

                        <button class="btn btn-success btn-block" onclick="addPoint()">
                            ‚ûï Add Point
                        </button>

                        <div class="coordinate-list" id="coordinateList"></div>

                        <button class="btn btn-primary btn-block" onclick="completeSurvey()" style="margin-top: 20px;">
                            ‚úÖ Complete Survey
                        </button>
                    </div>
                </div>
            </div>

            <!-- Plot & Calculate Tab -->
            <div id="plot" class="tab-content">
                <div class="card">
                    <h3>üìê Professional Survey Plotting & Calculations</h3>
                    
                    <div class="info-box">
                        <strong>Advanced Features:</strong> Calculate coordinates from bearing and distance, plot traverse points, compute areas, closures, and generate professional survey plots.
                    </div>

                    <h4 style="margin: 20px 0 15px 0;">Calculate Point from Bearing & Distance</h4>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Starting Northing (m)</label>
                            <input type="number" id="startNorthing" step="0.001" placeholder="Starting northing">
                        </div>
                        <div class="form-group">
                            <label>Starting Easting (m)</label>
                            <input type="number" id="startEasting" step="0.001" placeholder="Starting easting">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Bearing (Degrees, 0-360¬∞)</label>
                            <input type="number" id="bearing" step="0.01" min="0" max="360" placeholder="Enter bearing">
                        </div>
                        <div class="form-group">
                            <label>Distance (meters)</label>
                            <input type="number" id="distance" step="0.001" placeholder="Enter distance">
                        </div>
                    </div>

                    <button class="btn btn-primary" onclick="calculateCoordinate()">
                        üßÆ Calculate Coordinate
                    </button>

                    <div id="calculatedResult" style="display: none; margin-top: 20px;">
                        <div class="result-box">
                            <h4>üìä Calculated Coordinates</h4>
                            <div class="result-grid">
                                <div class="result-item">
                                    <label>Northing</label>
                                    <div class="value" id="calcNorthing">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Easting</label>
                                    <div class="value" id="calcEasting">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Bearing</label>
                                    <div class="value" id="calcBearing">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Distance</label>
                                    <div class="value" id="calcDistance">-</div>
                                </div>
                            </div>
                            <button class="btn btn-success btn-block" onclick="addCalculatedPoint()" style="margin-top: 15px;">
                                ‚ûï Add to Plot
                            </button>
                        </div>
                    </div>

                    <h4 style="margin: 30px 0 15px 0;">Survey Plot</h4>
                    <div class="plot-controls">
                        <button class="btn btn-secondary" onclick="clearPlot()">üóëÔ∏è Clear Plot</button>
                        <button class="btn btn-primary" onclick="exportPlot()">üíæ Export Plot</button>
                        <button class="btn btn-success" onclick="calculateArea()">üìä Calculate Area</button>
                    </div>

                    <canvas id="plotCanvas" width="800" height="600"></canvas>

                    <div id="plotPoints" class="coordinate-list"></div>

                    <div id="areaResult" style="display: none;">
                        <div class="result-box">
                            <h4>üìê Area Calculations</h4>
                            <div class="result-grid">
                                <div class="result-item">
                                    <label>Area (sq m)</label>
                                    <div class="value" id="areaSqM">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Hectares</label>
                                    <div class="value" id="areaHa">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Acres</label>
                                    <div class="value" id="areaAc">-</div>
                                </div>
                                <div class="result-item">
                                    <label>Perimeter (m)</label>
                                    <div class="value" id="perimeter">-</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Equipment Rental Tab -->
            <div id="equipment" class="tab-content">
                <div class="card">
                    <h3>üéØ Professional Survey Equipment Rental</h3>
                    
                    <div class="payment-split">
                        <h4 style="margin-bottom: 15px;">üí∞ Revenue Sharing Model</h4>
                        <div class="payment-split-item">
                            <span>Platform Commission (You)</span>
                            <span class="percentage">45%</span>
                        </div>
                        <div class="payment-split-item">
                            <span>Equipment Rental Partner</span>
                            <span class="percentage">55%</span>
                        </div>
                        <p style="margin-top: 15px; opacity: 0.9; font-size: 0.9em;">
                            All transactions are securely processed. Equipment providers receive 55% of rental fees.
                        </p>
                    </div>

                    <div class="equipment-card">
                        <h4>üéØ High-Precision Total Station</h4>
                        <p>Leica TS16 Total Station with automatic target recognition and remote positioning.</p>
                        <p class="price">‚Ç¶20,000 <span style="font-size: 0.5em; font-weight: normal;">/day</span></p>
                        <ul style="margin: 15px 0; color: var(--text-light);">
                            <li>‚úÖ Accuracy: 1" angular, 1mm + 1.5ppm distance</li>
                            <li>‚úÖ Bluetooth & WiFi connectivity</li>
                            <li>‚úÖ Automated measurements</li>
                            <li>‚úÖ Includes tripod and accessories</li>
                        </ul>
                        <button class="btn btn-primary" onclick="rentEquipment('Total Station', 20000)">
                            üõí Rent Now
                        </button>
                    </div>

                    <div class="equipment-card">
                        <h4>üì° RTK GPS/GNSS Receiver</h4>
                        <p>Trimble R12i GNSS System with real-time kinematic positioning.</p>
                        <p class="price">‚Ç¶15,000 <span style="font-size: 0.5em; font-weight: normal;">/day</span></p>
                        <ul style="margin: 15px 0; color: var(--text-light);">
                            <li>‚úÖ RTK accuracy: 8mm + 1ppm horizontal</li>
                            <li>‚úÖ Multi-constellation support</li>
                            <li>‚úÖ Integrated UHF radio</li>
                            <li>‚úÖ Cloud connectivity</li>
                        </ul>
                        <button class="btn btn-primary" onclick="rentEquipment('RTK GPS Receiver', 15000)">
                            üõí Rent Now
                        </button>
                    </div>

                    <div class="equipment-card">
                        <h4>üìè Digital Level</h4>
                        <p>Leica DNA03 Digital Level for precise elevation measurements.</p>
                        <p class="price">‚Ç¶8,000 <span style="font-size: 0.5em; font-weight: normal;">/day</span></p>
                        <ul style="margin: 15px 0; color: var(--text-light);">
                            <li>‚úÖ Accuracy: 0.3mm per km</li>
                            <li>‚úÖ Automatic readings</li>
                            <li>‚úÖ Data storage & transfer</li>
                            <li>‚úÖ Includes leveling staff</li>
                        </ul>
                        <button class="btn btn-primary" onclick="rentEquipment('Digital Level', 8000)">
                            üõí Rent Now
                        </button>
                    </div>

                    <div class="equipment-card">
                        <h4>üöÅ Survey Drone</h4>
                        <p>DJI Phantom 4 RTK with high-precision positioning for aerial surveys.</p>
                        <p class="price">‚Ç¶25,000 <span style="font-size: 0.5em; font-weight: normal;">/day</span></p>
                        <ul style="margin: 15px 0; color: var(--text-light);">
                            <li>‚úÖ Centimeter-level positioning</li>
                            <li>‚úÖ 20MP camera sensor</li>
                            <li>‚úÖ Photogrammetry software included</li>
                            <li>‚úÖ Flight planning tools</li>
                        </ul>
                        <button class="btn btn-primary" onclick="rentEquipment('Survey Drone', 25000)">
                            üõí Rent Now
                        </button>
                    </div>

                    <div class="equipment-card">
                        <h4>üîç Theodolite</h4>
                        <p>Topcon DT-209 Electronic Theodolite for angle measurements.</p>
                        <p class="price">‚Ç¶6,000 <span style="font-size: 0.5em; font-weight: normal;">/day</span></p>
                        <ul style="margin: 15px 0; color: var(--text-light);">
                            <li>‚úÖ Accuracy: 9" angular measurement</li>
                            <li>‚úÖ Dual-axis compensation</li>
                            <li>‚úÖ Digital display</li>
                            <li>‚úÖ Battery powered</li>
                        </ul>
                        <button class="btn btn-primary" onclick="rentEquipment('Theodolite', 6000)">
                            üõí Rent Now
                        </button>
                    </div>
                </div>
            </div>

            <!-- Learning Hub Tab -->
            <div id="learning" class="tab-content">
                <div class="card">
                    <h3>üìö Professional Surveying Learning Hub</h3>
                    
                    <div class="payment-split">
                        <h4 style="margin-bottom: 15px;">üí° Revenue Sharing for Education</h4>
                        <div class="payment-split-item">
                            <span>Platform Commission (You)</span>
                            <span class="percentage">45%</span>
                        </div>
                        <div class="payment-split-item">
                            <span>Education Provider</span>
                            <span class="percentage">55%</span>
                        </div>
                        <p style="margin-top: 15px; opacity: 0.9; font-size: 0.9em;">
                            Learn from industry experts. Course providers receive 55% of enrollment fees.
                        </p>
                    </div>

                    <div class="warning-box">
                        <strong>üéì Partner Resources:</strong> We partner with leading educational platforms to bring you the best surveying courses, certifications, and reference materials.
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">üìñ Recommended Books & Resources</h4>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üìò Elementary Surveying: An Introduction to Geomatics</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">By Charles D. Ghilani & Paul R. Wolf</p>
                            <p>Comprehensive introduction to modern surveying techniques, coordinate systems, and geospatial technology.</p>
                            <p style="margin-top: 10px;"><strong>Topics:</strong> Theodolites, Total Stations, GPS/GNSS, Traversing, Leveling, Coordinate Geometry</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.amazon.com/Elementary-Surveying-Introduction-Geomatics-15th/dp/0134604652')">
                                üìö View on Amazon
                            </button>
                        </div>
                    </div>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üìó Surveying with Construction Applications</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">By Barry Kavanagh</p>
                            <p>Practical guide focusing on construction surveying, site layout, and modern instrumentation.</p>
                            <p style="margin-top: 10px;"><strong>Topics:</strong> Construction Layout, Site Planning, Machine Control, 3D Modeling</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.amazon.com/Surveying-Construction-Applications-Barry-Kavanagh/dp/0134414454')">
                                üìö View on Amazon
                            </button>
                        </div>
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">üéì Online Courses & Certifications</h4>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üåê Coursera: Geographic Information Systems (GIS) Specialization</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">University of California, Davis</p>
                            <p>Master GIS fundamentals, spatial analysis, and geospatial data visualization.</p>
                            <p style="margin-top: 10px;"><strong>Duration:</strong> 5 months | <strong>Level:</strong> Beginner to Intermediate</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.coursera.org/specializations/gis')">
                                üéì Enroll Now
                            </button>
                        </div>
                    </div>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üåê Udemy: Complete Land Surveying Course</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">Professional Surveying Training</p>
                            <p>Learn total station operation, GPS surveying, coordinate calculations, and field procedures.</p>
                            <p style="margin-top: 10px;"><strong>Duration:</strong> 12 hours | <strong>Level:</strong> All Levels</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.udemy.com/topic/land-surveying/')">
                                üéì View Courses
                            </button>
                        </div>
                    </div>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üåê LinkedIn Learning: Surveying Foundations</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">Professional Development</p>
                            <p>Comprehensive surveying basics including measurement techniques, technology, and professional practices.</p>
                            <p style="margin-top: 10px;"><strong>Duration:</strong> 3 hours | <strong>Level:</strong> Beginner</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.linkedin.com/learning/topics/surveying')">
                                üéì Start Learning
                            </button>
                        </div>
                    </div>

                    <h4 style="margin: 25px 0 15px 0;">üîß Software Training</h4>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üíª AutoCAD Civil 3D for Surveyors</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">Autodesk Official Training</p>
                            <p>Master Civil 3D for survey data processing, surface modeling, and deliverable creation.</p>
                            <p style="margin-top: 10px;"><strong>Platform:</strong> Autodesk University</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.autodesk.com/training')">
                                üíª Learn Civil 3D
                            </button>
                        </div>
                    </div>

                    <div class="learning-card">
                        <div class="learning-content">
                            <h4 style="color: var(--primary);">üó∫Ô∏è ArcGIS for Surveyors</h4>
                            <p style="color: var(--text-light); margin: 10px 0;">Esri Training</p>
                            <p>Learn to manage survey data, create maps, and perform spatial analysis with ArcGIS.</p>
                            <p style="margin-top: 10px;"><strong>Platform:</strong> Esri Academy</p>
                            <button class="btn btn-primary" onclick="redirectToLearning('https://www.esri.com/training/')">
                                üó∫Ô∏è Explore ArcGIS Training
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Results Tab -->
            <div id="results" class="tab-content">
                <div class="card">
                    <h3>‚úÖ Survey Results & History</h3>
                    
                    <div id="surveyResults" class="table-responsive">
                        <p style="text-align: center; padding: 40px; color: var(--text-light);">
                            No completed surveys yet. Start a new survey to see results here.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast" class="toast">
        <div id="toastMessage"></div>
    </div>

    <script>
        // Global variables
        let surveyPoints = [];
        let plotPoints = [];
        let currentSurvey = null;
        let completedSurveys = [];
        let canvas, ctx;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            canvas = document.getElementById('plotCanvas');
            ctx = canvas.getContext('2d');
            initializePlot();
            loadSurveyHistory();
        });

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active to clicked tab
            event.target.classList.add('active');
        }

        // Start survey
        function startSurvey() {
            const clientName = document.getElementById('clientName').value;
            const projectName = document.getElementById('projectName').value;
            
            if (!clientName || !projectName) {
                showToast('Please enter client name and project name', 'warning');
                return;
            }

            currentSurvey = {
                id: generateId(),
                type: document.getElementById('surveyType').value,
                client: clientName,
                project: projectName,
                coordSystem: document.getElementById('coordSystem').value,
                date: document.getElementById('surveyDate').value || new Date().toISOString().split('T')[0],
                location: document.getElementById('location').value,
                points: [],
                startTime: new Date().toISOString()
            };

            surveyPoints = [];
            document.getElementById('activeSurvey').style.display = 'block';
            updateSurveyStats();
            showToast('Survey started successfully!', 'success');
        }

        // Add point
        function addPoint() {
            const northing = parseFloat(document.getElementById('northing').value);
            const easting = parseFloat(document.getElementById('easting').value);
            const elevation = parseFloat(document.getElementById('elevation').value);
            const description = document.getElementById('pointDesc').value;

            if (isNaN(northing) || isNaN(easting)) {
                showToast('Please enter valid coordinates', 'warning');
                return;
            }

            const point = {
                id: surveyPoints.length + 1,
                northing: northing,
                easting: easting,
                elevation: elevation || 0,
                description: description || `Point ${surveyPoints.length + 1}`,
                timestamp: new Date().toISOString()
            };

            surveyPoints.push(point);
            currentSurvey.points = surveyPoints;

            // Clear inputs
            document.getElementById('northing').value = '';
            document.getElementById('easting').value = '';
            document.getElementById('elevation').value = '';
            document.getElementById('pointDesc').value = '';

            updateSurveyStats();
            displayCoordinates();
            showToast('Point added successfully!', 'success');
        }

        // Update survey stats
        function updateSurveyStats() {
            document.getElementById('pointCount').textContent = surveyPoints.length;
            
            if (surveyPoints.length >= 3) {
                const area = calculatePolygonArea(surveyPoints);
                const hectares = area / 10000;
                const acres = hectares * 2.47105;
                
                document.getElementById('areaHectares').textContent = hectares.toFixed(4);
                document.getElementById('areaAcres').textContent = acres.toFixed(4);
            }
        }

        // Display coordinates
        function displayCoordinates() {
            const list = document.getElementById('coordinateList');
            list.innerHTML = '<h4 style="margin-bottom: 10px;">Recorded Points</h4>';
            
            surveyPoints.forEach((point, index) => {
                const div = document.createElement('div');
                div.className = 'coordinate-item';
                div.innerHTML = `
                    <div>
                        <strong>Point ${point.id}:</strong> N: ${point.northing.toFixed(3)}, E: ${point.easting.toFixed(3)}, Elev: ${point.elevation.toFixed(3)}
                        ${point.description ? `<br><small style="color: var(--text-light);">${point.description}</small>` : ''}
                    </div>
                    <span class="badge badge-success">‚úì</span>
                `;
                list.appendChild(div);
            });
        }

        // Complete survey
        function completeSurvey() {
            if (surveyPoints.length < 3) {
                showToast('Need at least 3 points to complete survey', 'warning');
                return;
            }

            const area = calculatePolygonArea(surveyPoints);
            const hectares = area / 10000;
            const acres = hectares * 2.47105;

            currentSurvey.endTime = new Date().toISOString();
            currentSurvey.area = {
                sqMeters: area,
                hectares: hectares,
                acres: acres
            };
            currentSurvey.verificationCode = generateVerificationCode();

            completedSurveys.push(currentSurvey);
            saveSurveyHistory();
            
            showSurveyComplete(currentSurvey);
            
            // Reset
            surveyPoints = [];
            currentSurvey = null;
            document.getElementById('activeSurvey').style.display = 'none';
            document.getElementById('clientName').value = '';
            document.getElementById('projectName').value = '';
            document.getElementById('location').value = '';
        }

        // Show survey complete
        function showSurveyComplete(survey) {
            const modal = `
                <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 9999;" onclick="this.remove()">
                    <div style="background: white; padding: 40px; border-radius: 20px; max-width: 600px; text-align: center;" onclick="event.stopPropagation()">
                        <div style="font-size: 4em; margin-bottom: 20px;">‚úÖ</div>
                        <h2 style="color: var(--success); margin-bottom: 20px;">Survey Complete!</h2>
                        
                        <div class="verification-code">
                            <div style="font-size: 0.9em; margin-bottom: 10px; color: var(--text-light);">Verification Code</div>
                            <div class="code">${survey.verificationCode}</div>
                        </div>
                        
                        <div class="result-grid" style="margin: 20px 0;">
                            <div class="result-item" style="background: rgba(124, 58, 237, 0.1);">
                                <label style="color: var(--primary);">Hectares</label>
                                <div class="value" style="color: var(--primary);">${survey.area.hectares.toFixed(4)}</div>
                            </div>
                            <div class="result-item" style="background: rgba(16, 185, 129, 0.1);">
                                <label style="color: var(--success);">Acres</label>
                                <div class="value" style="color: var(--success);">${survey.area.acres.toFixed(4)}</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: var(--bg-light); border-radius: 8px; text-align: left;">
                            <strong>Survey Details:</strong><br>
                            Project: ${survey.project}<br>
                            Client: ${survey.client}<br>
                            Points: ${survey.points.length}<br>
                            Coordinate System: ${survey.coordSystem}
                        </div>
                        
                        <button class="btn btn-primary" onclick="this.closest('[onclick]').remove(); switchTab('results')" style="margin-top: 20px;">
                            View Results
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modal);
        }

        // Calculate coordinate from bearing and distance
        function calculateCoordinate() {
            const startN = parseFloat(document.getElementById('startNorthing').value);
            const startE = parseFloat(document.getElementById('startEasting').value);
            const bearing = parseFloat(document.getElementById('bearing').value);
            const distance = parseFloat(document.getElementById('distance').value);

            if (isNaN(startN) || isNaN(startE) || isNaN(bearing) || isNaN(distance)) {
                showToast('Please enter all values', 'warning');
                return;
            }

            // Convert bearing to radians
            const bearingRad = bearing * Math.PI / 180;

            // Calculate coordinates
            const newN = startN + (distance * Math.cos(bearingRad));
            const newE = startE + (distance * Math.sin(bearingRad));

            // Display results
            document.getElementById('calcNorthing').textContent = newN.toFixed(3);
            document.getElementById('calcEasting').textContent = newE.toFixed(3);
            document.getElementById('calcBearing').textContent = bearing.toFixed(2) + '¬∞';
            document.getElementById('calcDistance').textContent = distance.toFixed(3) + 'm';
            
            document.getElementById('calculatedResult').style.display = 'block';
            
            // Store for adding to plot
            window.calculatedPoint = { northing: newN, easting: newE };
        }

        // Add calculated point to plot
        function addCalculatedPoint() {
            if (window.calculatedPoint) {
                plotPoints.push({
                    id: plotPoints.length + 1,
                    northing: window.calculatedPoint.northing,
                    easting: window.calculatedPoint.easting,
                    description: `Calculated Point ${plotPoints.length + 1}`
                });
                
                updatePlot();
                displayPlotPoints();
                showToast('Point added to plot!', 'success');
            }
        }

        // Initialize plot
        function initializePlot() {
            ctx.fillStyle = '#f9fafb';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw grid
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            
            for (let i = 0; i <= canvas.width; i += 50) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            
            for (let i = 0; i <= canvas.height; i += 50) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }
        }

        // Update plot
        function updatePlot() {
            initializePlot();
            
            if (plotPoints.length === 0) return;

            // Find bounds
            const northings = plotPoints.map(p => p.northing);
            const eastings = plotPoints.map(p => p.easting);
            
            const minN = Math.min(...northings);
            const maxN = Math.max(...northings);
            const minE = Math.min(...eastings);
            const maxE = Math.max(...eastings);
            
            const rangeN = maxN - minN || 1;
            const rangeE = maxE - minE || 1;
            
            const margin = 50;
            const plotWidth = canvas.width - 2 * margin;
            const plotHeight = canvas.height - 2 * margin;
            
            // Draw lines
            if (plotPoints.length > 1) {
                ctx.strokeStyle = '#7c3aed';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                plotPoints.forEach((point, i) => {
                    const x = margin + ((point.easting - minE) / rangeE) * plotWidth;
                    const y = canvas.height - margin - ((point.northing - minN) / rangeN) * plotHeight;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                });
                
                // Close polygon
                ctx.closePath();
                ctx.stroke();
                
                // Fill
                ctx.fillStyle = 'rgba(124, 58, 237, 0.1)';
                ctx.fill();
            }
            
            // Draw points
            plotPoints.forEach((point, i) => {
                const x = margin + ((point.easting - minE) / rangeE) * plotWidth;
                const y = canvas.height - margin - ((point.northing - minN) / rangeN) * plotHeight;
                
                // Point
                ctx.fillStyle = '#10b981';
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, 2 * Math.PI);
                ctx.fill();
                
                // Label
                ctx.fillStyle = '#111827';
                ctx.font = '12px Arial';
                ctx.fillText(`P${point.id}`, x + 8, y - 8);
            });
        }

        // Display plot points
        function displayPlotPoints() {
            const list = document.getElementById('plotPoints');
            list.innerHTML = '<h4 style="margin: 20px 0 10px 0;">Plot Points</h4>';
            
            plotPoints.forEach(point => {
                const div = document.createElement('div');
                div.className = 'coordinate-item';
                div.innerHTML = `
                    <div>
                        <strong>Point ${point.id}:</strong> N: ${point.northing.toFixed(3)}, E: ${point.easting.toFixed(3)}
                    </div>
                    <span class="badge badge-primary">Plotted</span>
                `;
                list.appendChild(div);
            });
        }

        // Calculate area
        function calculateArea() {
            if (plotPoints.length < 3) {
                showToast('Need at least 3 points to calculate area', 'warning');
                return;
            }

            const area = calculatePolygonArea(plotPoints);
            const hectares = area / 10000;
            const acres = hectares * 2.47105;
            
            // Calculate perimeter
            let perimeter = 0;
            for (let i = 0; i < plotPoints.length; i++) {
                const p1 = plotPoints[i];
                const p2 = plotPoints[(i + 1) % plotPoints.length];
                const dist = Math.sqrt(Math.pow(p2.northing - p1.northing, 2) + Math.pow(p2.easting - p1.easting, 2));
                perimeter += dist;
            }

            document.getElementById('areaSqM').textContent = area.toFixed(2);
            document.getElementById('areaHa').textContent = hectares.toFixed(4);
            document.getElementById('areaAc').textContent = acres.toFixed(4);
            document.getElementById('perimeter').textContent = perimeter.toFixed(2);
            
            document.getElementById('areaResult').style.display = 'block';
        }

        // Calculate polygon area using shoelace formula
        function calculatePolygonArea(points) {
            let area = 0;
            for (let i = 0; i < points.length; i++) {
                const j = (i + 1) % points.length;
                area += points[i].easting * points[j].northing;
                area -= points[j].easting * points[i].northing;
            }
            return Math.abs(area / 2);
        }

        // Clear plot
        function clearPlot() {
            if (confirm('Clear all plot points?')) {
                plotPoints = [];
                initializePlot();
                document.getElementById('plotPoints').innerHTML = '';
                document.getElementById('areaResult').style.display = 'none';
                showToast('Plot cleared', 'success');
            }
        }

        // Export plot
        function exportPlot() {
            const link = document.createElement('a');
            link.download = `survey-plot-${new Date().toISOString().split('T')[0]}.png`;
            link.href = canvas.toDataURL();
            link.click();
            showToast('Plot exported successfully!', 'success');
        }

        // Rent equipment
        function rentEquipment(equipment, price) {
            const yourCommission = price * 0.45;
            const partnerFee = price * 0.55;
            
            const message = `
                <div style="text-align: center;">
                    <h3>üéØ Equipment Rental</h3>
                    <p style="margin: 20px 0;"><strong>${equipment}</strong></p>
                    <div style="background: var(--bg-light); padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <div style="margin-bottom: 10px;">
                            <strong>Total Price:</strong> ‚Ç¶${price.toLocaleString()}/day
                        </div>
                        <div style="margin-bottom: 10px; color: var(--success);">
                            <strong>Your Commission (45%):</strong> ‚Ç¶${yourCommission.toLocaleString()}
                        </div>
                        <div style="color: var(--primary);">
                            <strong>Partner Fee (55%):</strong> ‚Ç¶${partnerFee.toLocaleString()}
                        </div>
                    </div>
                    <p style="color: var(--text-light); font-size: 0.9em;">
                        This rental will be processed through our partner network. You'll receive booking confirmation via email.
                    </p>
                    <button class="btn btn-primary" onclick="processRental('${equipment}', ${price})">
                        Confirm Booking
                    </button>
                </div>
            `;
            
            showModal(message);
        }

        // Process rental
        function processRental(equipment, price) {
            // In a real application, this would integrate with payment processing
            showToast(`Booking request sent for ${equipment}. You'll receive confirmation shortly.`, 'success');
            closeModal();
            
            // Redirect to partner site (example)
            setTimeout(() => {
                const partnerUrl = 'https://www.nationalequipment.com/equipment-rental/'; // Example partner
                window.open(partnerUrl, '_blank');
            }, 1000);
        }

        // Redirect to learning resource
        function redirectToLearning(url) {
            window.open(url, '_blank');
            showToast('Opening learning resource...', 'success');
        }

        // Generate ID
        function generateId() {
            return 'SRV-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        // Generate verification code
        function generateVerificationCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = 'NGS-';
            for (let i = 0; i < 8; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }

        // Show toast
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            let icon = 'üìã';
            if (type === 'success') icon = '‚úÖ';
            if (type === 'warning') icon = '‚ö†Ô∏è';
            if (type === 'error') icon = '‚ùå';
            
            toastMessage.innerHTML = `<strong>${icon} ${message}</strong>`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Show modal
        function showModal(content) {
            const modal = `
                <div id="customModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); display: flex; align-items: center; justify-content: center; z-index: 9999;">
                    <div style="background: white; padding: 40px; border-radius: 20px; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                        ${content}
                        <button class="btn btn-secondary btn-block" onclick="closeModal()" style="margin-top: 20px;">
                            Close
                        </button>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modal);
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('customModal');
            if (modal) modal.remove();
        }

        // Save survey history
        function saveSurveyHistory() {
            localStorage.setItem('surveyHistory', JSON.stringify(completedSurveys));
            displaySurveyHistory();
        }

        // Load survey history
        function loadSurveyHistory() {
            const saved = localStorage.getItem('surveyHistory');
            if (saved) {
                completedSurveys = JSON.parse(saved);
                displaySurveyHistory();
            }
        }

        // Display survey history
        function displaySurveyHistory() {
            const container = document.getElementById('surveyResults');
            
            if (completedSurveys.length === 0) {
                container.innerHTML = '<p style="text-align: center; padding: 40px; color: var(--text-light);">No completed surveys yet. Start a new survey to see results here.</p>';
                return;
            }

            let html = '<table><thead><tr><th>Project</th><th>Client</th><th>Date</th><th>Points</th><th>Area (Ha)</th><th>Area (Ac)</th><th>Verification Code</th></tr></thead><tbody>';
            
            completedSurveys.reverse().forEach(survey => {
                html += `
                    <tr>
                        <td><strong>${survey.project}</strong></td>
                        <td>${survey.client}</td>
                        <td>${survey.date}</td>
                        <td>${survey.points.length}</td>
                        <td>${survey.area.hectares.toFixed(4)}</td>
                        <td>${survey.area.acres.toFixed(4)}</td>
                        <td><span class="badge badge-success">${survey.verificationCode}</span></td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
    </script>
</body>
</html>
